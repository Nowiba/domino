<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domino Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }

        #game-container {
            width: 100%;
            max-width: 600px;
            text-align: center;
            padding: 20px;
        }

        #board {
            border: 2px solid #ccc;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 200px;
            position: relative;
        }

        .tile {
            display: inline-block;
            width: 40px;
            height: 80px;
            line-height: 80px;
            border: 1px solid #000;
            margin: 5px;
            text-align: center;
            font-size: 24px;
        }

        #player-hand {
            border: 2px solid #ccc;
            padding: 20px;
            margin-bottom: 20px;
        }

        #controls button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database.js"></script>
</head>
<body>
    <div id="game-container">
        <div id="board"></div>
        <div id="player-hand"></div>
        <div id="controls">
            <button id="create-game">Create Game</button>
            <button id="join-game">Join Game</button>
        </div>
    </div>

    <script>
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyCMxiBRciVQ9oKeiw3X9hxv_4BhDKABtgQ",
          authDomain: "web-site-ftw.firebaseapp.com",
          databaseURL: "https://web-site-ftw-default-rtdb.europe-west1.firebasedatabase.app",
          projectId: "web-site-ftw",
          storageBucket: "web-site-ftw.firebasestorage.app",
          messagingSenderId: "275070822133",
          appId: "1:275070822133:web:f1fdc6c20b5af4690fc7bc",
          measurementId: "G-PZ7JBGQWQE"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // DOM Elements
        const board = document.getElementById('board');
        const playerHand = document.getElementById('player-hand');
        const createGameButton = document.getElementById('create-game');
        const joinGameButton = document.getElementById('join-game');

        // Game State
        let gameId = null;
        let playerId = null;

        // Create a new game
        createGameButton.addEventListener('click', () => {
            console.log("Create Game button clicked");
            gameId = `game_${Math.random().toString(36).substr(2, 9)}`;
            playerId = `player_${Math.random().toString(36).substr(2, 9)}`;
            set(ref(database, `games/${gameId}`), {
                players: { [playerId]: true },
                board: [],
                hands: { [playerId]: [] }
            }).then(() => {
                console.log("Game created successfully");
                alert(`Game Created! ID: ${gameId}`);
            }).catch((error) => {
                console.error("Error creating game:", error);
            });
        });

        // Join an existing game
        joinGameButton.addEventListener('click', () => {
            console.log("Join Game button clicked");
            const gameIdToJoin = prompt("Enter Game ID to join:");
            if (gameIdToJoin) {
                gameId = gameIdToJoin;
                playerId = `player_${Math.random().toString(36).substr(2, 9)}`;
                const gameRef = ref(database, `games/${gameId}/players/${playerId}`);
                set(gameRef, true).then(() => {
                    console.log("Joined game successfully");
                    alert(`Joined Game! ID: ${gameId}`);
                }).catch((error) => {
                    console.error("Error joining game:", error);
                });
            }
        });

        // Listen for game state changes
        function listenForGameUpdates() {
            if (gameId) {
                const gameRef = ref(database, `games/${gameId}`);
                onValue(gameRef, (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        console.log("Game state updated:", data);
                        updateBoard(data.board);
                        updatePlayerHand(data.hands[playerId]);
                    }
                });
            }
        }

        // Update the board display
        function updateBoard(boardState) {
            board.innerHTML = '';
            boardState.forEach(tile => {
                const tileElement = document.createElement('div');
                tileElement.className = 'tile';
                tileElement.textContent = tile;
                board.appendChild(tileElement);
            });
        }

        // Update the player's hand display
        function updatePlayerHand(hand) {
            playerHand.innerHTML = '';
            hand.forEach(tile => {
                const tileElement = document.createElement('div');
                tileElement.className = 'tile';
                tileElement.textContent = tile;
                playerHand.appendChild(tileElement);
            });
        }

        // Start listening for updates
        listenForGameUpdates();
    </script>
</body>
</html>
